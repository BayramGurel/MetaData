2025-03-24 14:55:04,132 - root - INFO - CKAN connection established with API key (header method).
2025-03-24 14:55:04,239 - root - ERROR - CKAN API error: ['https://orange-fiesta-jw6wwxvv69524v4-5000.app.github.dev/api/action/package_list', 401, '']
2025-03-24 14:56:13,242 - root - ERROR -   Manual request failed: Expecting value: line 1 column 1 (char 0)
2025-03-24 14:56:22,226 - root - ERROR -   Manual request failed: Expecting value: line 1 column 1 (char 0)
2025-03-24 14:58:25,254 - root - INFO - CKAN connection established with API key (header method).
2025-03-24 14:58:25,312 - root - ERROR - CKAN API error: ['https://orange-fiesta-jw6wwxvv69524v4-5000.app.github.dev/api/action/package_list', 401, '']
2025-03-24 14:59:12,637 - root - INFO - Attempting connection WITHOUT API key...
2025-03-24 14:59:12,714 - root - WARNING - Connection WITHOUT API key failed: ['https://orange-fiesta-jw6wwxvv69524v4-5000.app.github.dev/api/action/package_list', 401, '']
2025-03-24 14:59:12,714 - root - INFO - Attempting connection WITH API key (header method)...
2025-03-24 14:59:12,779 - root - ERROR - CKAN API error (with API key, header method): ['https://orange-fiesta-jw6wwxvv69524v4-5000.app.github.dev/api/action/package_list', 401, '']
2025-03-24 14:59:12,779 - root - INFO - Attempting connection WITH API key (URL method - less secure)...
2025-03-24 14:59:12,829 - root - ERROR - CKAN API error (with API key, URL method): ['https://orange-fiesta-jw6wwxvv69524v4-5000.app.github.dev?apikey=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJqdGkiOiJTNTJzZHFjdUxpR0VwejdzWUlXeVBqOGNnQTVUT3MxbUpQMnczdW1Za1V3IiwiaWF0IjoxNzQyNzQyNzQxfQ.-aQ9TK3APCppQE_gpwe--CBvrgFHBFGejZnyRmj7HnE/api/action/package_list', 401, '']
2025-03-24 14:59:12,829 - root - ERROR - CKAN connection failed.  Exiting pipeline.
2025-03-24 15:01:44,869 - root - INFO - Attempting connection WITHOUT API key...
2025-03-24 15:01:44,927 - root - WARNING - Connection WITHOUT API key failed: ['https://orange-fiesta-jw6wwxvv69524v4-5000.app.github.dev/api/action/package_list', 401, '']
2025-03-24 15:01:44,927 - root - INFO - Attempting connection WITH API key (header method)...
2025-03-24 15:01:44,981 - root - ERROR - CKAN API error (with API key, header method): ['https://orange-fiesta-jw6wwxvv69524v4-5000.app.github.dev/api/action/package_list', 401, '']
2025-03-24 15:01:44,982 - root - INFO - Attempting connection WITH API key (URL method - less secure)...
2025-03-24 15:01:45,041 - root - ERROR - CKAN API error (with API key, URL method): ['https://orange-fiesta-jw6wwxvv69524v4-5000.app.github.dev?apikey=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJqdGkiOiJTNTJzZHFjdUxpR0VwejdzWUlXeVBqOGNnQTVUT3MxbUpQMnczdW1Za1V3IiwiaWF0IjoxNzQyNzQyNzQxfQ.-aQ9TK3APCppQE_gpwe--CBvrgFHBFGejZnyRmj7HnE/api/action/package_list', 401, '']
2025-03-24 15:01:45,041 - root - ERROR - CKAN connection failed.  Exiting pipeline.
2025-03-24 15:03:03,928 - root - INFO - Attempting anonymous connection to CKAN...
2025-03-24 15:03:03,995 - root - ERROR - CKAN API error (anonymous connection): ['https://orange-fiesta-jw6wwxvv69524v4-5000.app.github.dev/api/action/package_list', 401, '']
2025-03-24 15:03:03,996 - root - ERROR - CKAN connection failed.  Exiting pipeline.
2025-03-24 15:07:23,375 - root - INFO - Attempting connection WITHOUT API key...
2025-03-24 15:07:23,429 - root - WARNING - Connection WITHOUT API key failed: ['https://orange-fiesta-jw6wwxvv69524v4-5000.app.github.dev/api/action/package_list', 401, '']
2025-03-24 15:07:23,429 - root - INFO - Attempting connection WITH API key (header method)...
2025-03-24 15:07:23,480 - root - ERROR - CKAN API error (with API key, header method): ['https://orange-fiesta-jw6wwxvv69524v4-5000.app.github.dev/api/action/package_list', 401, '']
2025-03-24 15:07:23,481 - root - INFO - Attempting connection WITH API key (URL method - less secure)...
2025-03-24 15:07:23,528 - root - ERROR - CKAN API error (with API key, URL method): ['https://orange-fiesta-jw6wwxvv69524v4-5000.app.github.dev?apikey=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJqdGkiOiJTNTJzZHFjdUxpR0VwejdzWUlXeVBqOGNnQTVUT3MxbUpQMnczdW1Za1V3IiwiaWF0IjoxNzQyNzQyNzQxfQ.-aQ9TK3APCppQE_gpwe--CBvrgFHBFGejZnyRmj7HnE/api/action/package_list', 401, '']
2025-03-24 15:07:23,528 - root - ERROR - CKAN connection failed.  Exiting pipeline.
2025-03-24 15:08:30,395 - root - INFO - Attempting connection WITHOUT API key...
2025-03-24 15:08:30,483 - root - WARNING - Connection WITHOUT API key failed: ['https://orange-fiesta-jw6wwxvv69524v4-5000.app.github.dev/api/action/package_list', 401, '']
2025-03-24 15:08:30,484 - root - INFO - Attempting connection WITH API key (header method)...
2025-03-24 15:08:30,567 - root - ERROR - CKAN API error (with API key, header method): ['https://orange-fiesta-jw6wwxvv69524v4-5000.app.github.dev/api/action/package_list', 401, '']
2025-03-24 15:08:30,567 - root - INFO - Attempting connection WITH API key (URL method - less secure)...
2025-03-24 15:08:30,630 - root - ERROR - CKAN API error (with API key, URL method): ['https://orange-fiesta-jw6wwxvv69524v4-5000.app.github.dev?apikey=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJqdGkiOiJTNTJzZHFjdUxpR0VwejdzWUlXeVBqOGNnQTVUT3MxbUpQMnczdW1Za1V3IiwiaWF0IjoxNzQyNzQyNzQxfQ.-aQ9TK3APCppQE_gpwe--CBvrgFHBFGejZnyRmj7HnE/api/action/package_list', 401, '']
2025-03-24 15:08:30,630 - root - ERROR - CKAN connection failed.  Exiting pipeline.
2025-03-24 15:08:35,755 - root - INFO - Attempting anonymous connection to CKAN...
2025-03-24 15:08:35,806 - root - ERROR - CKAN API error (anonymous connection): ['https://orange-fiesta-jw6wwxvv69524v4-5000.app.github.dev/api/action/package_list', 401, '']
2025-03-24 15:08:35,807 - root - ERROR - CKAN connection failed.  Exiting pipeline.
2025-03-25 13:04:47,430 - root - INFO - Attempting anonymous connection to CKAN...
2025-03-25 13:04:47,500 - root - ERROR - CKAN API error (anonymous connection): ['https://orange-fiesta-jw6wwxvv69524v4-5000.app.github.dev/api/action/package_list', 401, '']
2025-03-25 13:04:47,500 - root - ERROR - CKAN connection failed.  Exiting pipeline.
2025-03-27 14:09:50,982 - DataPipeline - INFO - Logging configured for 'DataPipeline'. Level: INFO, Console Level: INFO, File: C:\Users\gurelb\Documents\GitHub\MetaData\data_pipeline.log
2025-03-27 14:09:50,982 - DataPipeline - INFO - Initializing Data Pipeline components...
2025-03-27 14:09:51,654 - DataPipeline - INFO - ==================== Starting Data Pipeline Run ====================
2025-03-27 14:09:51,654 - DataPipeline - CRITICAL - CKAN connection failed during initialization. Pipeline cannot continue.
2025-03-27 14:22:50,063 - DataPipeline - INFO - Logging configured for 'DataPipeline'. Level: INFO, Console Level: INFO, File: C:\Users\gurelb\Documents\GitHub\MetaData\data_pipeline.log
2025-03-27 14:22:50,064 - DataPipeline - INFO - Initializing Data Pipeline components...
2025-03-27 14:22:50,125 - DataPipeline - INFO - ==================== Starting Data Pipeline Run ====================
2025-03-27 14:22:50,125 - DataPipeline - CRITICAL - CKAN connection failed during initialization. Pipeline cannot continue.
2025-03-27 14:25:04,671 - DataPipeline - INFO - Logging configured for 'DataPipeline'. Level: INFO, Console Level: INFO, File: C:\Users\gurelb\Documents\GitHub\MetaData\data_pipeline.log
2025-03-27 14:25:04,671 - DataPipeline - INFO - Initializing Data Pipeline components...
2025-03-27 14:25:04,720 - DataPipeline - INFO - ==================== Starting Data Pipeline Run ====================
2025-03-27 14:25:04,720 - DataPipeline - CRITICAL - CKAN connection failed during initialization. Pipeline cannot continue.
2025-03-27 14:46:55,102 - DataPipeline - INFO - Logging configured for 'DataPipeline'. Level: INFO, Console Level: INFO, File: C:\Users\gurelb\Documents\GitHub\MetaData\data_pipeline.log
2025-03-27 14:46:55,102 - DataPipeline - INFO - Initializing Data Pipeline components...
2025-03-27 14:46:55,439 - DataPipeline - INFO - ==================== Starting Data Pipeline Run ====================
2025-03-27 14:46:55,439 - DataPipeline - CRITICAL - CKAN connection failed during initialization. Pipeline cannot continue.
2025-03-27 14:47:24,008 - DataPipeline - INFO - Logging configured for 'DataPipeline'. Level: INFO, Console Level: INFO, File: C:\Users\gurelb\Documents\GitHub\MetaData\data_pipeline.log
2025-03-27 14:47:24,009 - DataPipeline - INFO - Initializing Data Pipeline components...
2025-03-27 14:47:24,361 - DataPipeline - INFO - ==================== Starting Data Pipeline Run ====================
2025-03-27 14:47:24,361 - DataPipeline - CRITICAL - CKAN connection failed during initialization. Pipeline cannot continue.
2025-03-27 14:49:02,322 - DataPipeline - INFO - Logging configured for 'DataPipeline'. Level: INFO, Console Level: INFO, File: C:\Users\gurelb\Documents\GitHub\MetaData\data_pipeline.log
2025-03-27 14:49:02,323 - DataPipeline - INFO - Initializing Data Pipeline components...
2025-03-27 14:49:02,675 - DataPipeline - INFO - ==================== Starting Data Pipeline Run ====================
2025-03-27 14:49:02,675 - DataPipeline - INFO - Starting scan of directory: C:\Users\gurelb\Downloads\RTest
2025-03-27 14:49:02,676 - DataPipeline - INFO - Scan complete: No processable items found.
2025-03-27 14:50:01,253 - DataPipeline - INFO - Logging configured for 'DataPipeline'. Level: INFO, Console Level: INFO, File: C:\Users\gurelb\Documents\GitHub\MetaData\data_pipeline.log
2025-03-27 14:50:01,253 - DataPipeline - INFO - Initializing Data Pipeline components...
2025-03-27 14:50:01,615 - DataPipeline - INFO - ==================== Starting Data Pipeline Run ====================
2025-03-27 14:50:01,615 - DataPipeline - INFO - Starting scan of directory: C:\Users\gurelb\Downloads\RTest
2025-03-27 14:50:02,493 - DataPipeline - INFO - Scan complete: Found 2 initial items.
2025-03-27 14:50:02,493 - DataPipeline - INFO - Starting metadata validation...
2025-03-27 14:50:02,493 - DataPipeline - INFO - Validation complete: No issues found.
2025-03-27 14:50:02,493 - DataPipeline - ERROR - CRITICAL: An unexpected error occurred during pipeline execution:
Traceback (most recent call last):
  File "C:\Users\gurelb\Documents\GitHub\MetaData\main.py", line 118, in run
    log.info(f"Starting upload process for {len(items_to_process)} items to CKAN: {config.config.CKAN_API_URL.host}...")
                                                                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'host'
2025-03-27 14:50:02,495 - DataPipeline - INFO - ==================== Data Pipeline Run Failed ====================
2025-03-27 14:53:07,672 - DataPipeline - INFO - Logging configured for 'DataPipeline'. Level: INFO, Console Level: INFO, File: C:\Users\gurelb\Documents\GitHub\MetaData\data_pipeline.log
2025-03-27 14:53:07,672 - DataPipeline - INFO - Initializing Data Pipeline components...
2025-03-27 14:53:08,025 - DataPipeline - INFO - ==================== Starting Data Pipeline Run ====================
2025-03-27 14:53:08,025 - DataPipeline - INFO - Starting scan of directory: C:\Users\gurelb\Downloads\RTest
2025-03-27 14:53:08,907 - DataPipeline - INFO - Scan complete: Found 2 initial items.
2025-03-27 14:53:08,907 - DataPipeline - INFO - Starting metadata validation...
2025-03-27 14:53:08,908 - DataPipeline - INFO - Validation complete: No issues found.
2025-03-27 14:53:08,908 - DataPipeline - INFO - Starting upload process for 2 items...
2025-03-27 14:53:08,908 - DataPipeline - INFO - ... Target CKAN instance: orange-fiesta-jw6wwxvv69524v4-5000.app.github.dev
2025-03-27 14:53:08,921 - DataPipeline - ERROR - CRITICAL: An unexpected error occurred during pipeline execution:
Traceback (most recent call last):
  File "C:\Users\gurelb\Documents\GitHub\MetaData\load_publish.py", line 141, in get_or_create_dataset
    existing_ds = self._execute_action("package_show", {"id": dataset_slug}, log_prefix)
  File "C:\Users\gurelb\Documents\GitHub\MetaData\load_publish.py", line 106, in _execute_action
    if last_exception: raise last_exception # type: ignore
                       ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\gurelb\Documents\GitHub\MetaData\load_publish.py", line 93, in _execute_action
    return self.ckan.action.__getattribute__(action)(**params)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^
AttributeError: 'ActionShortcut' object has no attribute 'package_show'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\gurelb\Documents\GitHub\MetaData\main.py", line 119, in run
    resource_count, dataset_count = self.uploader.process_list(
                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~^
        metadata_list=items_to_process,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        resource_field_map=config.config.CKAN_RESOURCE_FIELD_MAP
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\gurelb\Documents\GitHub\MetaData\load_publish.py", line 334, in process_list
    dataset_id = self.get_or_create_dataset(prep_info.target_dataset_slug, org_id, prep_info.dataset_payload)
  File "C:\Users\gurelb\Documents\GitHub\MetaData\load_publish.py", line 166, in get_or_create_dataset
    if not existing_ds and isinstance(e, ValidationError) and 'name' in getattr(e, 'error_dict', {}):
           ^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'existing_ds' where it is not associated with a value
2025-03-27 14:53:08,924 - DataPipeline - INFO - ==================== Data Pipeline Run Failed ====================
2025-03-27 14:57:12,346 - DataPipeline - INFO - Logging configured for 'DataPipeline'. Level: INFO, Console Level: INFO, File: C:\Users\gurelb\Documents\GitHub\MetaData\data_pipeline.log
2025-03-27 14:57:12,346 - DataPipeline - INFO - Initializing Data Pipeline components...
2025-03-27 14:57:12,773 - DataPipeline - INFO - ==================== Starting Data Pipeline Run ====================
2025-03-27 14:57:12,773 - DataPipeline - INFO - Starting scan of directory: C:\Users\gurelb\Downloads\RTest
2025-03-27 14:57:13,628 - DataPipeline - INFO - Scan complete: Found 2 initial items.
2025-03-27 14:57:13,628 - DataPipeline - INFO - Starting metadata validation...
2025-03-27 14:57:13,629 - DataPipeline - INFO - Validation complete: No issues found.
2025-03-27 14:57:13,629 - DataPipeline - INFO - Starting upload process for 2 items...
2025-03-27 14:57:13,629 - DataPipeline - INFO - ... Target CKAN instance: orange-fiesta-jw6wwxvv69524v4-5000.app.github.dev
2025-03-27 14:57:14,781 - DataPipeline - INFO - Upload process complete. Processed 0 resources across 0 unique datasets.
2025-03-27 14:57:14,781 - DataPipeline - INFO - ==================== Data Pipeline Run Finished Successfully ====================
2025-03-27 15:07:11,796 - DataPipeline - INFO - Logging configured for 'DataPipeline'. Level: INFO, Console Level: INFO, File: C:\Users\gurelb\Documents\GitHub\MetaData\data_pipeline.log
2025-03-27 15:07:11,796 - DataPipeline - INFO - Initializing Data Pipeline components...
2025-03-27 15:07:12,122 - DataPipeline - INFO - ==================== Starting Data Pipeline Run ====================
2025-03-27 15:07:12,123 - DataPipeline - INFO - Starting scan of directory: C:\Users\gurelb\Downloads\RTest
2025-03-27 15:07:13,044 - DataPipeline - INFO - Scan complete: Found 2 initial items.
2025-03-27 15:07:13,044 - DataPipeline - INFO - Starting metadata validation...
2025-03-27 15:07:13,044 - DataPipeline - INFO - Validation complete: No issues found.
2025-03-27 15:07:13,044 - DataPipeline - INFO - Starting upload process for 2 items...
2025-03-27 15:07:13,045 - DataPipeline - INFO - ... Target CKAN instance: orange-fiesta-jw6wwxvv69524v4-5000.app.github.dev
2025-03-27 15:07:14,888 - DataPipeline - INFO - Upload process complete. Processed 0 resources across 1 unique datasets.
2025-03-27 15:07:14,888 - DataPipeline - INFO - ==================== Data Pipeline Run Finished Successfully ====================
2025-03-27 15:11:42,471 - DataPipeline - INFO - Logging configured for 'DataPipeline'. Level: INFO, Console Level: INFO, File: C:\Users\gurelb\Documents\GitHub\MetaData\data_pipeline.log
2025-03-27 15:11:42,471 - DataPipeline - INFO - Initializing Data Pipeline components...
2025-03-27 15:11:42,796 - DataPipeline - INFO - ==================== Starting Data Pipeline Run ====================
2025-03-27 15:11:42,796 - DataPipeline - INFO - Starting scan of directory: C:\Users\gurelb\Downloads\RTest
2025-03-27 15:11:42,831 - DataPipeline - INFO - Scan complete: Found 1 initial items.
2025-03-27 15:11:42,831 - DataPipeline - INFO - Starting metadata validation...
2025-03-27 15:11:42,831 - DataPipeline - INFO - Validation complete: No issues found.
2025-03-27 15:11:42,831 - DataPipeline - INFO - Starting upload process for 1 items...
2025-03-27 15:11:42,831 - DataPipeline - INFO - ... Target CKAN instance: orange-fiesta-jw6wwxvv69524v4-5000.app.github.dev
2025-03-27 15:11:44,101 - DataPipeline - INFO - Upload process complete. Processed 0 resources across 1 unique datasets.
2025-03-27 15:11:44,102 - DataPipeline - INFO - ==================== Data Pipeline Run Finished Successfully ====================
2025-03-27 15:11:44,102 - DataPipeline - INFO - Cleaning up main scan temporary directory: C:\Users\gurelb\Documents\GitHub\MetaData\temp_extraction\scan_20250327_141142
2025-03-27 15:11:44,102 - DataPipeline - INFO - Main scan temporary directory cleaned.
2025-03-27 15:12:17,368 - DataPipeline - INFO - Logging configured for 'DataPipeline'. Level: INFO, Console Level: INFO, File: C:\Users\gurelb\Documents\GitHub\MetaData\data_pipeline.log
2025-03-27 15:12:17,369 - DataPipeline - INFO - Initializing Data Pipeline components...
2025-03-27 15:12:17,760 - DataPipeline - INFO - ==================== Starting Data Pipeline Run ====================
2025-03-27 15:12:17,760 - DataPipeline - INFO - Starting scan of directory: C:\Users\gurelb\Downloads\RTest
2025-03-27 15:12:17,761 - DataPipeline - ERROR - CRITICAL: An unexpected error occurred during pipeline execution:
Traceback (most recent call last):
  File "C:\Users\gurelb\Documents\GitHub\MetaData\main.py", line 65, in run
    scan_temp_dir_to_clean = self.scanner.run_temp_dir # <<< Assign before scan potentially changes it
                             ^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'MetadataScanner' object has no attribute 'run_temp_dir'
2025-03-27 15:12:17,762 - DataPipeline - INFO - ==================== Data Pipeline Run Failed ====================
2025-03-27 15:12:35,669 - DataPipeline - INFO - Logging configured for 'DataPipeline'. Level: INFO, Console Level: INFO, File: C:\Users\gurelb\Documents\GitHub\MetaData\data_pipeline.log
2025-03-27 15:12:35,669 - DataPipeline - INFO - Initializing Data Pipeline components...
2025-03-27 15:12:35,813 - DataPipeline - INFO - ==================== Starting Data Pipeline Run ====================
2025-03-27 15:12:35,813 - DataPipeline - INFO - Starting scan of directory: C:\Users\gurelb\Downloads\RTest
2025-03-27 15:12:35,849 - DataPipeline - INFO - Scan complete: Found 1 initial items.
2025-03-27 15:12:35,849 - DataPipeline - INFO - Starting metadata validation...
2025-03-27 15:12:35,849 - DataPipeline - INFO - Validation complete: No issues found.
2025-03-27 15:12:35,849 - DataPipeline - INFO - Starting upload process for 1 items...
2025-03-27 15:12:35,849 - DataPipeline - INFO - ... Target CKAN instance: orange-fiesta-jw6wwxvv69524v4-5000.app.github.dev
2025-03-27 15:12:36,482 - DataPipeline - INFO - Upload process complete. Processed 0 resources across 1 unique datasets.
2025-03-27 15:12:36,482 - DataPipeline - INFO - ==================== Data Pipeline Run Finished Successfully ====================
2025-03-27 15:12:36,483 - DataPipeline - INFO - Cleaning up main scan temporary directory: C:\Users\gurelb\Documents\GitHub\MetaData\temp_extraction\scan_20250327_141235
2025-03-27 15:12:36,483 - DataPipeline - INFO - Main scan temporary directory cleaned.
